services:
  - type: web
    name: ai-service
    runtime: docker
    dockerfilePath: ./ai-service/Dockerfile
    dockerContext: ./ai-service
    plan: starter
    region: oregon
    envVars:
      - key: OPENAI_API_KEY
        sync: false
      - key: EMBEDDING_CACHE_TTL_SECONDS
        value: "900"
      - key: EMBEDDING_CACHE_MAX_ENTRIES
        value: "512"
      - key: EMBEDDING_MAX_BATCH
        value: "32"
      - key: EMBEDDING_MAX_INPUT_CHARS
        value: "16000"
      - key: MATCH_CACHE_TTL_SECONDS
        value: "300"
      - key: MATCH_CACHE_MAX_ENTRIES
        value: "1024"
      - key: MATCH_MIN_SCORE
        value: "0.3"
      - key: MATCH_MAX_RESULTS
        value: "20"
      - key: MATCH_FRESHNESS_HALF_LIFE_DAYS
        value: "30"
      - key: FEEDBACK_MODEL
        value: "gpt-4o-mini"
    healthCheckPath: /health

